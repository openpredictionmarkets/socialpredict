# Separation of Concerns in interfaces.go

Separation-of-concerns assessment for `backend/internal/domain/markets/interfaces.go`: **mixed (good intent, partial execution)**.

What’s good:
1. Service capabilities are explicitly split into focused interfaces (`CoreService`, `SearchService`, `LeaderboardService`, `PositionsService`, `ProjectionService`) in `backend/internal/domain/markets/interfaces.go:47`.
2. External dependencies are abstracted (`CreatorProfileService`, `WalletService`, `Clock`) in `backend/internal/domain/markets/interfaces.go:10`, `backend/internal/domain/markets/interfaces.go:32`, `backend/internal/domain/markets/interfaces.go:38`.

Main concerns:
1. `ServiceInterface` re-aggregates everything (`backend/internal/domain/markets/interfaces.go:84`), and many consumers still depend on that full surface even when they use 1-2 methods, e.g. `backend/handlers/positions/positionshandler.go:16`, `backend/handlers/bets/betshandler.go:16`, `backend/handlers/users/userpositiononmarkethandler.go:17`.  
   This weakens interface segregation and creates heavy mocks (`backend/handlers/positions/positionshandler_test.go:43`, `backend/handlers/bets/betshandler_test.go:23`).
2. `Repository` mixes persistence CRUD/search with derived/computation responsibilities (`GetUserPosition`, `ListMarketPositions`, `CalculatePayoutPositions`, `GetPublicMarket`) in `backend/internal/domain/markets/interfaces.go:15`.  
   That’s multiple concerns in one boundary.
3. `CreatorProfileService` returns `*users.PublicUser` (`backend/internal/domain/markets/interfaces.go:35`), which leaks another domain’s model into markets boundary.
4. `WalletService` includes `ValidateBalance` (`backend/internal/domain/markets/interfaces.go:40`) but markets logic currently uses `Debit/Credit` paths (`backend/internal/domain/markets/market_creation.go:87`, `backend/internal/domain/markets/market_resolution.go:65`), so the interface is broader than current need.

Net: the file shows strong SoC direction, but the broad aggregate interfaces (`ServiceInterface`, `Repository`) are currently diluting that separation in real usage.

## Splitting Up ServiceInterface

Keep existing focused interfaces (CoreService, SearchService, LeaderboardService, PositionsService, ProjectionService) in interfaces.go (line 47).
Stop passing ServiceInterface to handlers that need only one capability:
positionshandler.go (line 16) -> PositionsService
userpositiononmarkethandler.go (line 17) -> PositionsService
betshandler.go (line 16) -> tiny GetMarketBets interface or ProjectionService
publicresponsemarket.go (line 30) -> tiny GetPublicMarket interface or CoreService
Then deprecate/remove ServiceInterface in interfaces.go (line 84).
